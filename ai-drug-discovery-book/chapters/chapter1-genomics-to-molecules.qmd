
# Chapter 1: Genomics to Molecules


This chapter introduces the journey from genomics data to actionable molecular targets in drug discovery. It covers how genetic information is translated into protein targets and how these are linked to small molecules for therapeutic intervention.

---



## Workflow Overview
The following diagram illustrates the overall process from genomics data to actionable molecules in drug discovery:

```{mermaid}
graph TD;
	classDef light fill:#f9f9f9,stroke:#333,stroke-width:1px;
	Main[main.py]:::light
	Crew[agents/multi_agent.py]:::light
	PubMedTool[tools/pubmed.py]:::light
	PubChemTool[tools/pubchem.py]:::light
	DB[db/mongodb.py]:::light
	DataRaw[data/raw/]:::light
	DataProcessed[data/processed/]:::light
	UtilsNode[app/utils/]:::light

	Main --> Crew
	Crew --> PubMedTool
	Crew --> PubChemTool
	PubMedTool -->|fetches| DataRaw
	PubChemTool -->|fetches| DataRaw
	Crew --> DB
	Main --> UtilsNode
	Crew --> UtilsNode
	Main -->|returns| Main
```

---


---

## Summary

This workflow demonstrates how to start from a gene (e.g., SOD1 for ALS), find the corresponding protein (UniProt), retrieve known small-molecule ligands (ChEMBL), and analyze their molecular properties. This bridges genomics and cheminformatics, enabling rational drug discovery starting from genetic information.



## Key Code Snippets
## Further Reading

@opentargets
@uniprot
@chembl
@pdb

### 1. Retrieve ALS Target Genes from Open Targets
```python
import requests
efo_id = "Orphanet_803"  # ALS
ot_url = f"https://platform-api.opentargets.io/v3/platform/public/association/filter?disease={efo_id}&size=30&fields=target.gene_info.symbol,target.gene_info.name,association_score.overall"
resp = requests.get(ot_url)
gene_hits = resp.json().get('data', [])
als_genes = [g['target']['gene_info']['symbol'] for g in gene_hits]
print('Top ALS target genes:', als_genes)
```

### 2. Batch Extract Non-Protein Entities from PDB
```python
import requests, pandas as pd
pdb_ids = ['2RSQ', '4RFX', '7WWT', ...]  # your PDB list
all_results = []
for pdb_id in pdb_ids:
	url = f'https://data.rcsb.org/rest/v1/core/entry/{pdb_id}'
	resp = requests.get(url)
	if resp.status_code == 200:
		data = resp.json()
		for entity in data.get('nonpolymer_entities', []):
			chem_comp = entity.get('chem_comp', {})
			all_results.append({
				'pdb_id': pdb_id,
				---

				## Interpretation of Exported Ligands for ALS Drug Discovery

				At the end of this workflow, the notebook exports a file `ligands_for_docking.csv` containing known ligands for the selected ALS target (e.g., SOD1). Here is an example of the exported data:

				| name         | smiles                                                        |
				|--------------|---------------------------------------------------------------|
				| CHEMBL273030 | c1ccc2cc3c(NCCc4c[nH]cn4)nnc(NCCc4c[nH]cn4)c3cc2c1           |
				| CHEMBL272808 | Clc1nnc(NCCc2c[nH]cn2)c2cc3ccccc3cc12                        |
				| CHEMBL272641 | c1ccc2cc3c(NCCCn4ccnc4)nnc(NCCCn4ccnc4)c3cc2c1               |
				| CHEMBL405899 | Clc1nnc(NCCCn2ccnc2)c2cc3ccccc3cc12                          |
				| CHEMBL1672028| c1ccc2cc3c(Nc4cc[nH]n4)nnc(Nc4cc[nH]n4)c3cc2c1               |

				**How to interpret these results:**

				- These ligands are ChEMBL compounds with known bioactivity, retrieved for the ALS target SOD1.
				- Their structures are consistent with CNS drug-like scaffolds, but further ADMET and blood-brain barrier predictions are needed for ALS relevance.
				- These molecules are not validated ALS drugs, but are reasonable starting points for hit discovery and virtual screening.
				- The CSV can be used directly in docking or cheminformatics pipelines to prioritize or design new compounds.

				**Limitations:**
				- The activity data is typically from in vitro assays, not ALS disease models.
				- Further experimental validation is required to confirm efficacy and safety in ALS.

				**Summary:**
				The notebook provides a practical, automated way to go from ALS gene to actionable ligand lists for computational drug discovery, enabling rapid hypothesis generation and screening for ALS research.
				'entity_id': chem_comp.get('id', ''),
				'entity_name': chem_comp.get('name', ''),
				'entity_type': chem_comp.get('type', '')
			})
pd.DataFrame(all_results).to_csv('batch_als_pdb_entities.csv', index=False)
```

### 3. Find Known Ligands for a Target in ChEMBL
```python
from chembl_webresource_client.new_client import new_client
target = new_client.target
activity = new_client.activity
acc = 'P00441'  # UniProt for SOD1
targets = list(target.filter(target_components__accession=acc))
chembl_id = targets[0]['target_chembl_id']
acts = activity.filter(target_chembl_id=chembl_id, standard_type='IC50')
for a in list(acts)[:5]:
	print(a.get('molecule_chembl_id'), a.get('standard_value'))
```


## Notebook Link

For the full workflow, see the interactive notebook: [chapter1-genomics-to-molecules.ipynb](../notebooks/chapter1-genomics-to-molecules.ipynb)



## 1.1 Introduction to Genomics in Drug Discovery
Genomics provides the foundation for modern drug discovery by identifying genes associated with diseases. Advances in sequencing technologies and bioinformatics enable researchers to pinpoint genetic variants and pathways involved in disease mechanisms, offering new opportunities for therapeutic intervention.

## 1.2 From Genes to Proteins
Genes encode proteins, which are the functional molecules in cells. Understanding how genetic information is translated into protein structure and function is crucial for identifying druggable targets. Databases like UniProt provide comprehensive information on protein sequences, structures, and functions.

## 1.3 Target Identification and Validation
Target identification involves linking disease-associated genes to specific proteins that can be modulated by drugs. Validation ensures that modulating the target will have a therapeutic effect. This process uses data from genomics, proteomics, and functional studies, and often leverages resources like Open Targets and experimental validation.

## 1.4 Linking Targets to Molecules
Once a target protein is identified and validated, the next step is to find small molecules that interact with it. This involves searching bioactivity databases (e.g., ChEMBL) for known ligands, using structure-based methods to identify binding sites, and applying cheminformatics tools to analyze and prioritize compounds.

## 1.5 Case Study: ALS Gene to Ligand
Amyotrophic lateral sclerosis (ALS) is a neurodegenerative disease with several known genetic risk factors, such as mutations in the SOD1 gene. In this case study, we:
- Identify ALS-associated genes using Open Targets.
- Retrieve the corresponding protein (e.g., SOD1) from UniProt.
- Find known ligands for SOD1 in ChEMBL.
- Analyze ligand properties and prepare them for virtual screening or further optimization.

This workflow demonstrates how to bridge genomics and cheminformatics for rational drug discovery, starting from a disease gene and ending with actionable small molecules.

---

## Interpretation of Exported Ligands for ALS Drug Discovery

At the end of this workflow, the notebook exports a file `ligands_for_docking.csv` containing known ligands for the selected ALS target (e.g., SOD1). Here is an example of the exported data:

| name         | smiles                                                        |
|--------------|---------------------------------------------------------------|
| CHEMBL273030 | c1ccc2cc3c(NCCc4c[nH]cn4)nnc(NCCc4c[nH]cn4)c3cc2c1           |
| CHEMBL272808 | Clc1nnc(NCCc2c[nH]cn2)c2cc3ccccc3cc12                        |
| CHEMBL272641 | c1ccc2cc3c(NCCCn4ccnc4)nnc(NCCCn4ccnc4)c3cc2c1               |
| CHEMBL405899 | Clc1nnc(NCCCn2ccnc2)c2cc3ccccc3cc12                          |
| CHEMBL1672028| c1ccc2cc3c(Nc4cc[nH]n4)nnc(Nc4cc[nH]n4)c3cc2c1               |

**How to interpret these results:**

- These ligands are ChEMBL compounds with known bioactivity, retrieved for the ALS target SOD1.
- Their structures are consistent with CNS drug-like scaffolds, but further ADMET and blood-brain barrier predictions are needed for ALS relevance.
- These molecules are not validated ALS drugs, but are reasonable starting points for hit discovery and virtual screening.
- The CSV can be used directly in docking or cheminformatics pipelines to prioritize or design new compounds.

**Limitations:**
- The activity data is typically from in vitro assays, not ALS disease models.
- Further experimental validation is required to confirm efficacy and safety in ALS.

**Summary:**
The notebook provides a practical, automated way to go from ALS gene to actionable ligand lists for computational drug discovery, enabling rapid hypothesis generation and screening for ALS research.
