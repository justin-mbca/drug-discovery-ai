
# Chapter 7: Bioactivity Prediction

---

## Summary

Predicting the biological activity of molecules is central to drug discovery. This chapter covers data sources, machine learning models, and evaluation strategies for bioactivity prediction, including how to prepare data and assess model performance.

---

## Key Code Snippets

### 1. Load Bioactivity Data from ChEMBL
```python
from chembl_webresource_client.new_client import new_client
activity = new_client.activity
acts = activity.filter(target_chembl_id="CHEMBL25", standard_type="IC50")
for a in list(acts)[:5]:
	print(a['molecule_chembl_id'], a['standard_value'])
```

### 2. Train a Classifier for Bioactivity
```python
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
X = ...  # feature matrix
y = ...  # binary activity labels
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)
clf = RandomForestClassifier()
clf.fit(X_train, y_train)
print("Accuracy:", clf.score(X_test, y_test))
```

---

## Notebook Link

For a full workflow, see the interactive notebook: (notebook not available for this chapter)

---


## 7.1 Bioactivity Data Sources
Bioactivity data links chemical structures to their effects on biological targets. Key public sources include:
- **ChEMBL:** Large database of bioactive molecules with activity data (IC50, Ki, etc.) and assay details.
- **PubChem BioAssay:** Repository of biological assay results for small molecules.
- **BindingDB:** Focuses on binding affinities for protein-ligand complexes.
- **Other sources:** In-house screening data, literature mining, and collaborative consortia.

## 7.2 Feature Engineering for Bioactivity
Feature engineering transforms raw molecular data into numerical representations suitable for machine learning.
- **Molecular fingerprints:** ECFP (Morgan), MACCS, topological fingerprints.
- **Descriptors:** Physicochemical properties (e.g., MW, logP, H-bond donors/acceptors, TPSA).
- **Target features:** Protein sequence descriptors, structural features, or target class labels.
- **Data preprocessing:** Standardize SMILES, remove duplicates, handle missing values, and balance classes.

## 7.3 ML Models for Activity Prediction
Various machine learning models are used to predict bioactivity:
- **Random Forests:** Robust to noisy data, handle high-dimensional features well.
- **Support Vector Machines (SVM):** Effective for binary classification with clear margins.
- **Neural Networks:** Capture complex, non-linear relationships; can be used for regression or classification.
- **Deep Learning:** Graph neural networks (GNNs), convolutional networks for molecular graphs or SMILES.
- **Model selection:** Depends on data size, feature type, and interpretability needs.

## 7.4 Model Evaluation and Validation
Evaluating model performance is critical for reliable predictions.
- **Metrics:** Accuracy, ROC-AUC, precision, recall, F1-score for classification; RMSE, R2 for regression.
- **Cross-validation:** Use k-fold or stratified cross-validation to assess generalizability.
- **External validation:** Test on independent datasets or prospective experiments.
- **Interpretability:** Analyze feature importance, SHAP values, or model explanations to understand predictions.
