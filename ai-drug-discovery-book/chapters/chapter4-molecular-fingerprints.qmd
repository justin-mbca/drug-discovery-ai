
# Chapter 4: Molecular Fingerprints

Molecular fingerprints are compact representations of chemical structures used for similarity searching and machine learning. This chapter explains different types of fingerprints and their applications.

## 4.1 What Are Molecular Fingerprints?

Molecular fingerprints are binary or integer vectors that encode the presence or absence of particular substructures or features in a molecule. They allow rapid comparison of molecules for similarity searching, clustering, and as input features for machine learning models.

- **Purpose:**
	- Enable fast similarity searches in large chemical databases.
	- Provide a standardized input for cheminformatics and AI tasks.

- **How They Work:**
	- Each bit or value in the fingerprint corresponds to a specific structural feature or pattern.
	- The fingerprint is generated by analyzing the molecule's structure and mapping features to bits.

## 4.2 Types: MACCS, Morgan, Topological

There are several types of molecular fingerprints, each with different algorithms and applications:

- **MACCS Keys:**
	- 166-bit fingerprint where each bit represents a predefined substructure (e.g., aromatic ring, carboxyl group).
	- Simple and interpretable, commonly used for basic similarity searches.

- **Morgan (Circular) Fingerprints:**
	- Also known as ECFP (Extended-Connectivity Fingerprints).
	- Encodes atom environments up to a certain radius (e.g., ECFP4 uses radius 2).
	- Widely used in machine learning and virtual screening.
	- Example (Python/RDKit):
		```python
		from rdkit import Chem
		from rdkit.Chem import AllChem
		mol = Chem.MolFromSmiles('CCO')
		fp = AllChem.GetMorganFingerprintAsBitVect(mol, 2, nBits=1024)
		print(list(fp))
		```

- **Topological (Path-Based) Fingerprints:**
	- Encodes the presence of linear paths of atoms (e.g., Daylight fingerprints).
	- Good for capturing connectivity and substructure patterns.

## 4.3 Applications in Virtual Screening

Fingerprints are essential for virtual screening, where large libraries of compounds are searched for molecules similar to a known active compound.

- **Similarity Searching:**
	- Compare fingerprints using metrics like Tanimoto similarity to find similar molecules.

- **Substructure Searching:**
	- Identify compounds containing specific structural motifs.

- **Library Design:**
	- Cluster compounds based on fingerprint similarity to ensure chemical diversity.

## 4.4 Fingerprints in Machine Learning

Fingerprints are widely used as input features for machine learning models in cheminformatics.

- **Feature Vectors:**
	- Each molecule is represented by its fingerprint vector, which can be used as input to algorithms like random forests, SVMs, or neural networks.

- **QSAR Modeling:**
	- Quantitative Structure-Activity Relationship (QSAR) models use fingerprints to predict biological activity or properties.

- **Deep Learning:**
	- Fingerprints can be combined with other descriptors or used as input to deep learning models for property prediction, classification, or regression tasks.

**Example (Python/Scikit-learn):**
```python
from rdkit import Chem
from rdkit.Chem import AllChem
from sklearn.ensemble import RandomForestClassifier
import numpy as np

# Example molecules and labels
smiles = ['CCO', 'CCN', 'CCC', 'CCCl']
labels = [1, 0, 1, 0]
fps = [AllChem.GetMorganFingerprintAsBitVect(Chem.MolFromSmiles(s), 2, nBits=1024) for s in smiles]
X = np.array([list(fp) for fp in fps])

clf = RandomForestClassifier()
clf.fit(X, labels)
```
